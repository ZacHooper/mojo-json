from lexer import lex

from parser import is_special_token, parse
from types import (
    Value,
    JSON_SYNTAX,
    JSON_QUOTE,
    JsonList,
    JsonDict,
    JSON_LEFTBRACE,
    JSON_LEFTBRACKET,
    JSON_RIGHTBRACKET,
    JSON_COMMA,
)
from stringify import stringify


fn main() raises:
    var json: String = """
    {
        "name": "John",
        "age": 30,
        "wage": 25.4,
        "is_student": false,
        "has_job": true,
        "is_null": null,
        "nickname": ""
    }
    """
    print("Lexing JSON:")
    var tokens = lex(json)
    for token in range(len(tokens)):
        var token_str = stringify(tokens[token])
        print(token_str, end="")

    print("\n\nParsing JSON:")
    var json_value = parse(tokens)
    print(stringify(json_value))

    var json_2: String = """
    {
        "name": "John",
        "age": 30,
        "wage": 25.4,
        "is_student": false,
        "has_job": true,
        "is_null": null,
        "nickname": "",
        "friends": [
            "Alice",
            "Bob",
            "Charlie"
        ],
        "address": {
            "street": "123 Main St",
            "city": "Springfield",
            "state": "IL",
            "zip": 62701
        },
        "phone_numbers": {
            "home": "217-555-1234",
            "work": "312-555-1234",
            "cell": [
                "312-555-4321",
                "312-555-5432"
            ]
        }
    }
    """
    print("Lexing JSON:")
    var tokens_2 = lex(json_2)
    for token in range(len(tokens_2)):
        var token_str = stringify(tokens_2[token])
        print(token_str, end="")

    print("\n\nParsing JSON:")
    var json_value_2 = parse(tokens_2)
    print(stringify(json_value_2))
